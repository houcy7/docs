(window.webpackJsonp=window.webpackJsonp||[]).push([[17],{508:function(t,a,s){"use strict";s.r(a);var v=s(4),r=Object(v.a)({},(function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h2",{attrs:{id:"功能"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#功能"}},[t._v("#")]),t._v(" 功能")]),t._v(" "),s("p",[t._v("obf作为跑批调度的最后一步，负责对内部数仓（"),s("code",[t._v("v3")]),t._v(","),s("code",[t._v("v4")]),t._v(","),s("code",[t._v("dt")]),t._v(","),s("code",[t._v("wk")]),t._v("）和外部数仓("),s("code",[t._v("TLZFBL")]),t._v("，"),s("code",[t._v("TLZFBLADV")]),t._v("，"),s("code",[t._v("ZJZFBL")]),t._v(")进行调用。")]),t._v(" "),s("h2",{attrs:{id:"配置"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#配置"}},[t._v("#")]),t._v(" 配置")]),t._v(" "),s("p",[t._v("内部数据源通过接口"),s("code",[t._v("http://variate116.recall.ypcredit.com/uploadfile")]),t._v("上传文件，通过接口"),s("code",[t._v("http://variate116.recall.ypcredit.com/recall")]),t._v("\n发起数据源的调用。\n"),s("img",{attrs:{src:"https://tva1.sinaimg.cn/large/008i3skNly1grwr0q0skyj31dm0u0too.jpg",alt:""}})]),t._v(" "),s("p",[s("code",[t._v("通联")]),t._v("的回溯文件需要上传到"),s("code",[t._v("通联")]),t._v("的ftp服务器；\n"),s("img",{attrs:{src:"https://tva1.sinaimg.cn/large/008i3skNly1grwr1ihfpkj31do0u0gyb.jpg",alt:""}})]),t._v(" "),s("p",[t._v("通联ftp登录命令：")]),t._v(" "),s("div",{staticClass:"language-shell script extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("sftp")]),t._v(" -oPort"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("5022")]),t._v(" tianchuang@180.168.54.251 "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Lqo6^d1Pn"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("p",[s("code",[t._v("ZJ")]),t._v("的回溯文件则是存在"),s("code",[t._v("天创")]),t._v("的ftp服务器\n"),s("img",{attrs:{src:"https://tva1.sinaimg.cn/large/008i3skNly1grwr1xu0z1j61dj0u014x02.jpg",alt:""}})]),t._v(" "),s("h2",{attrs:{id:"内部数据源"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#内部数据源"}},[t._v("#")]),t._v(" 内部数据源"),s("Badge",{attrs:{text:"重点"}})],1),t._v(" "),s("p",[t._v("为了避免数仓资源浪费，而且数仓资源消耗和跑批任务成正比，所以在调用数仓时进行"),s("code",[t._v("同一数据源")]),t._v("文件的合并后交给数仓处理，并在"),s("code",[t._v("该类数据源")]),t._v("回调\n时进行下一次调用的触发，保证数仓侧同一数据源同时只会有一个任务在执行。")]),t._v(" "),s("h3",{attrs:{id:"调用"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#调用"}},[t._v("#")]),t._v(" 调用")]),t._v(" "),s("ul",[s("li",[t._v("dpm调用入口\n"),s("img",{attrs:{src:"https://tva1.sinaimg.cn/large/008i3skNly1grwracq4juj31dj0u0tp3.jpg",alt:""}})]),t._v(" "),s("li",[t._v("因内部数据源处理逻辑基本一致，将处理流程抽象出一个"),s("code",[t._v("模板")]),t._v("，通过"),s("code",[t._v("数据源类型标识")]),t._v("不同来区分不同的数据源，在"),s("code",[t._v("系统启动时")]),t._v("进行加载\n"),s("img",{attrs:{src:"https://tva1.sinaimg.cn/large/008i3skNly1grwrgef5mbj31dj0u04g5.jpg",alt:""}}),t._v(" "),s("img",{attrs:{src:"https://tva1.sinaimg.cn/large/008i3skNly1grwriudhd2j31dj0u0h3f.jpg",alt:""}})]),t._v(" "),s("li",[t._v("内部数据源处理逻辑\n"),s("img",{attrs:{src:"https://tva1.sinaimg.cn/large/008i3skNly1grwrkvmx56j31dj0u0kae.jpg",alt:""}})])]),t._v(" "),s("h3",{attrs:{id:"回调"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#回调"}},[t._v("#")]),t._v(" 回调")]),t._v(" "),s("ul",[s("li",[t._v("数仓回调："),s("code",[t._v("数仓")]),t._v("回调后由"),s("code",[t._v("obf")]),t._v("对"),s("code",[t._v("dpm")]),t._v("进行回调通知，更新obf回溯任务调用状态后"),s("code",[t._v("触发下一次调用")]),t._v(" "),s("img",{attrs:{src:"https://tva1.sinaimg.cn/large/008i3skNly1grwrppmaf9j31dj0u0tq9.jpg",alt:""}}),t._v(" "),s("img",{attrs:{src:"https://tva1.sinaimg.cn/large/008i3skNly1grwrslx31aj31dj0u01be.jpg",alt:""}})]),t._v(" "),s("li",[t._v('dpm手动回调：因"不可抗力"可能导致'),s("code",[t._v("数仓")]),t._v("无法正常回调"),s("code",[t._v("obf")]),t._v(",但是跑批任务已经完成，此时由"),s("code",[t._v("运营人员")]),t._v("通过"),s("code",[t._v("dpm")]),t._v("进行"),s("code",[t._v("手动回调")]),t._v("信用百科，\n但是此时"),s("code",[t._v("obf")]),t._v("中任务的状态需要同步更新，这样下一次任务才会正常的执行\n"),s("img",{attrs:{src:"https://tva1.sinaimg.cn/large/008i3skNly1grwrw9o23qj31dj0u07kv.jpg",alt:""}})])]),t._v(" "),s("h2",{attrs:{id:"外部数据源"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#外部数据源"}},[t._v("#")]),t._v(" 外部数据源"),s("Badge",{attrs:{text:"重点"}})],1),t._v(" "),s("p",[t._v("不同于内部数据源的调用过程，外部数据源的上传通过约定时间由"),s("code",[t._v("定时任务")]),t._v("将当天的同一数据源合并成一个文件上传的指定的ftp路径下，\n在一段时间后进行"),s("code",[t._v("主动处理")])]),t._v(" "),s("h3",{attrs:{id:"调用-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#调用-2"}},[t._v("#")]),t._v(" 调用")]),t._v(" "),s("ul",[s("li",[s("p",[t._v("进件样本的接收\n"),s("img",{attrs:{src:"https://tva1.sinaimg.cn/large/008i3skNly1grws2dmzw9j31dj0u0ndc.jpg",alt:""}})])]),t._v(" "),s("li",[s("p",[t._v("定时任务触发\n"),s("img",{attrs:{src:"https://tva1.sinaimg.cn/large/008i3skNly1grws3bplxrj31dj0u0k7b.jpg",alt:""}})])]),t._v(" "),s("li",[s("p",[t._v("因为不同数据源需要的字段可能不同，在模板类中添加了几个抽象方法，需要在子类中具体实现。\n"),s("img",{attrs:{src:"https://tva1.sinaimg.cn/large/008i3skNly1grws814zx6j31dj0u0wub.jpg",alt:""}})])])]),t._v(" "),s("h3",{attrs:{id:"回调-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#回调-2"}},[t._v("#")]),t._v(" 回调")]),t._v(" "),s("p",[s("code",[t._v("外部数据源")]),t._v("处理完成后通过"),s("code",[t._v("http")]),t._v("进行回调，"),s("code",[t._v("回调服务器ip")]),t._v("需"),s("code",[t._v("预置")]),t._v("到"),s("code",[t._v("ip白名单")]),t._v("中\n"),s("img",{attrs:{src:"https://tva1.sinaimg.cn/large/008i3skNly1grws9r8qv6j31dj0u0wva.jpg",alt:""}})]),t._v(" "),s("h3",{attrs:{id:"加急"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#加急"}},[t._v("#")]),t._v(" 加急")]),t._v(" "),s("p",[s("code",[t._v("外部数据源")]),t._v("处理时效一般为"),s("code",[t._v("T+1")]),t._v("，有紧急任务时，通过"),s("code",[t._v("dpm")]),t._v("触发"),s("code",[t._v("加急")]),t._v("操作，将"),s("code",[t._v("已上传")]),t._v("的回溯文件"),s("code",[t._v("提前合并")]),t._v("发送到"),s("code",[t._v("加急文件夹")]),t._v("下，并在相应的"),s("code",[t._v("运维群")]),t._v("中通知\n"),s("code",[t._v("对应负责人")]),t._v("手动处理。\n"),s("img",{attrs:{src:"https://tva1.sinaimg.cn/large/008i3skNly1grwsfbpc4fj31dj0u0qku.jpg",alt:""}})]),t._v(" "),s("ul",[s("li",[s("p",[t._v("TL加急路径\n"),s("img",{attrs:{src:"https://tva1.sinaimg.cn/large/008i3skNly1grwsgzvoefj31dj0u04gl.jpg",alt:""}})])]),t._v(" "),s("li",[s("p",[t._v("通联通知人\n"),s("img",{attrs:{src:"https://tva1.sinaimg.cn/large/008i3skNly1grwshzwfdzj314p0u0whd.jpg",alt:""}})])]),t._v(" "),s("li",[s("p",[t._v("ZJ加急路径\n"),s("img",{attrs:{src:"https://tva1.sinaimg.cn/large/008i3skNly1grwsg6m2s8j31dj0u0h04.jpg",alt:""}})])]),t._v(" "),s("li",[s("p",[t._v("ZJ通知人\n"),s("img",{attrs:{src:"https://tva1.sinaimg.cn/large/008i3skNly1grwsj7r5qyj313u0u0jua.jpg",alt:""}})])])]),t._v(" "),s("h2",{attrs:{id:"相关资料"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#相关资料"}},[t._v("#")]),t._v(" 相关资料")]),t._v(" "),s("ul",[s("li",[s("a",{attrs:{href:"http://wiki.tcredit.com/pages/viewpage.action?pageId=35390658",target:"_blank",rel:"noopener noreferrer"}},[t._v("内部源跑批任务回调接口"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"http://wiki.tcredit.com/pages/viewpage.action?pageId=35390404",target:"_blank",rel:"noopener noreferrer"}},[t._v("外部源跑批任务回调接口"),s("OutboundLink")],1)])])])}),[],!1,null,null,null);a.default=r.exports}}]);